<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auto Refresh</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      width: 370px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0f172a;
      color: #e2e8f0;
    }

    /* Header */
    .header {
      display: flex; align-items: center; gap: 10px;
      padding: 16px 20px 0;
    }
    .header-icon {
      width: 30px; height: 30px;
      background: linear-gradient(135deg, #3b82f6, #8b5cf6);
      border-radius: 8px; display: flex; align-items: center;
      justify-content: center; font-size: 15px; flex-shrink: 0;
    }
    .header h1 { font-size: 15px; font-weight: 700; color: #f1f5f9; }
    .header p  { font-size: 11px; color: #64748b; }

    /* Nav */
    .nav {
      display: flex; border-bottom: 1px solid #1e293b;
      margin-top: 14px; padding: 0 20px;
    }
    .nav button {
      flex: 1; background: none; border: none;
      border-bottom: 2px solid transparent;
      padding: 9px 0; font-size: 13px; font-weight: 500;
      color: #475569; cursor: pointer; transition: all 0.18s;
    }
    .nav button.active { color: #e2e8f0; border-bottom-color: #3b82f6; }
    .badge {
      display: inline-block; background: #3b82f6; color: white;
      font-size: 10px; font-weight: 700; border-radius: 10px;
      padding: 1px 6px; margin-left: 5px; vertical-align: middle;
    }
    .badge.hidden { display: none; }

    /* Pages */
    .page { display: none; padding: 16px 20px; }
    .page.active { display: block; }

    /* ‚îÄ‚îÄ ADD FORM ‚îÄ‚îÄ */
    .form-label {
      font-size: 11px; font-weight: 600; color: #64748b;
      text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px;
    }

    .mode-toggle {
      display: flex; background: #1e293b;
      border-radius: 8px; padding: 3px; margin-bottom: 10px;
    }
    .mode-toggle button {
      flex: 1; padding: 6px; border: none; background: transparent;
      color: #64748b; border-radius: 6px; cursor: pointer;
      font-size: 12px; font-weight: 500; transition: all 0.2s;
    }
    .mode-toggle button.active { background: #334155; color: #e2e8f0; }

    select, input[type="text"], input[type="number"] {
      width: 100%; background: #1e293b; border: 1px solid #334155;
      border-radius: 8px; padding: 8px 11px; color: #e2e8f0;
      font-size: 13px; outline: none; transition: border-color 0.2s;
    }
    select:focus, input:focus { border-color: #3b82f6; }
    input::placeholder { color: #475569; }

    .input-row { display: flex; gap: 7px; align-items: stretch; }
    .input-row input, .input-row select { flex: 1; width: auto; }

    .btn-ghost {
      background: #1e293b; border: 1px solid #334155; border-radius: 8px;
      padding: 8px 11px; color: #94a3b8; font-size: 12px; cursor: pointer;
      white-space: nowrap; transition: all 0.2s; flex-shrink: 0;
    }
    .btn-ghost:hover { border-color: #3b82f6; color: #3b82f6; }

    /* Interval row */
    .interval-row {
      display: flex; align-items: center; gap: 6px; margin-top: 8px;
    }
    .interval-row .form-label { margin: 0; white-space: nowrap; }
    .interval-pills { display: flex; gap: 4px; flex-wrap: wrap; }
    .interval-pill {
      background: #1e293b; border: 1px solid #334155; border-radius: 6px;
      padding: 4px 9px; color: #64748b; font-size: 11px; font-weight: 600;
      cursor: pointer; transition: all 0.15s;
    }
    .interval-pill:hover { border-color: #3b82f6; color: #93c5fd; }
    .interval-pill.sel { background: rgba(59,130,246,0.15); border-color: #3b82f6; color: #60a5fa; }
    .custom-min { display: flex; align-items: center; gap: 3px; }
    .custom-min input { width: 46px; padding: 4px 6px; font-size: 11px; text-align: center; }
    .custom-min span { font-size: 11px; color: #475569; }

    .btn-add {
      width: 100%; margin-top: 12px; padding: 10px; border: none;
      border-radius: 8px; font-size: 13px; font-weight: 600;
      background: linear-gradient(135deg, #3b82f6, #6366f1);
      color: white; cursor: pointer; transition: all 0.2s;
    }
    .btn-add:hover { opacity: 0.9; transform: translateY(-1px); }

    /* ‚îÄ‚îÄ WATCH LIST ‚îÄ‚îÄ */
    .section-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 10px; padding-top: 14px;
      border-top: 1px solid #1e293b;
    }
    .section-title { font-size: 12px; font-weight: 600; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; }

    .watch-list { display: flex; flex-direction: column; gap: 7px; }

    .watch-card {
      background: #1e293b; border: 1px solid #334155;
      border-radius: 10px; padding: 11px 13px;
      transition: border-color 0.15s;
    }
    .watch-card:hover { border-color: #475569; }

    .wc-top { display: flex; align-items: flex-start; gap: 8px; }
    .wc-pulse {
      width: 7px; height: 7px; border-radius: 50%; background: #22c55e;
      flex-shrink: 0; margin-top: 4px;
      animation: pulse 1.5s ease-in-out infinite;
    }
    .wc-info { flex: 1; min-width: 0; }
    .wc-title {
      font-size: 12px; font-weight: 600; color: #cbd5e1;
      overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
      margin-bottom: 2px; cursor: pointer; display: flex; align-items: center; gap: 5px;
    }
    .wc-title:hover .rename-hint { opacity: 1; }
    .rename-hint { font-size: 10px; color: #475569; opacity: 0; transition: opacity 0.15s; flex-shrink: 0; }
    .wc-rename-input {
      display: none; width: 100%; background: #0f172a; border: 1px solid #3b82f6;
      border-radius: 5px; padding: 3px 7px; color: #e2e8f0; font-size: 12px;
      font-weight: 600; outline: none; margin-bottom: 2px;
    }
    .wc-rename-input.visible { display: block; }
    .wc-url {
      font-size: 11px; color: #475569;
      overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    }
    .btn-remove {
      background: none; border: none; color: #475569; cursor: pointer;
      font-size: 15px; line-height: 1; padding: 2px 4px;
      border-radius: 4px; transition: all 0.15s; flex-shrink: 0;
    }
    .btn-remove:hover { background: rgba(239,68,68,0.15); color: #ef4444; }

    .wc-meta {
      display: flex; align-items: center; gap: 10px;
      margin-top: 8px; padding-top: 7px;
      border-top: 1px solid rgba(255,255,255,0.04);
    }
    .wc-stat { font-size: 11px; color: #475569; }
    .wc-stat strong { color: #94a3b8; font-weight: 600; }
    .wc-interval {
      font-size: 10px; font-weight: 700; padding: 2px 7px;
      border-radius: 10px; background: rgba(99,102,241,0.12);
      color: #818cf8; border: 1px solid rgba(99,102,241,0.2);
    }

    .wc-attempt {
      display: flex; align-items: center; gap: 5px; margin-left: auto;
    }
    .attempt-dot {
      width: 5px; height: 5px; border-radius: 50%; flex-shrink: 0;
    }
    .attempt-dot.refreshed { background: #22c55e; }
    .attempt-dot.locked    { background: #3b82f6; }
    .attempt-dot.skipped   { background: #f59e0b; }
    .attempt-label { font-size: 10px; }
    .attempt-label.refreshed { color: #4ade80; }
    .attempt-label.locked    { color: #60a5fa; }
    .attempt-label.skipped   { color: #fbbf24; }

    .empty-watches {
      text-align: center; padding: 20px 0 8px;
      font-size: 12px; color: #334155;
    }
    .empty-watches .icon { font-size: 24px; margin-bottom: 6px; }
    .empty-watches p { color: #475569; line-height: 1.5; }

    /* ‚îÄ‚îÄ HISTORY PAGE ‚îÄ‚îÄ */
    .history-toolbar {
      display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;
    }
    .history-toolbar span { font-size: 12px; color: #64748b; }
    .btn-clear {
      background: none; border: 1px solid #334155; border-radius: 6px;
      padding: 4px 10px; color: #64748b; font-size: 11px;
      cursor: pointer; transition: all 0.2s;
    }
    .btn-clear:hover { border-color: #ef4444; color: #ef4444; }

    .history-list {
      max-height: 350px; overflow-y: auto;
      display: flex; flex-direction: column; gap: 6px;
    }
    .history-list::-webkit-scrollbar { width: 4px; }
    .history-list::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }

    .history-item {
      background: #1e293b; border: 1px solid #334155;
      border-radius: 8px; padding: 9px 12px;
    }
    .hi-url {
      font-size: 12px; color: #60a5fa;
      overflow: hidden; text-overflow: ellipsis; white-space: nowrap; margin-bottom: 4px;
    }
    .hi-url a { color: inherit; text-decoration: none; }
    .hi-url a:hover { text-decoration: underline; }
    .hi-meta { display: flex; align-items: center; gap: 7px; flex-wrap: wrap; }
    .hi-time { font-size: 11px; color: #475569; }
    .hi-tag {
      font-size: 10px; font-weight: 600; padding: 1px 7px; border-radius: 10px;
    }
    .hi-tag.refreshed { background: rgba(34,197,94,0.1); color: #4ade80; border: 1px solid rgba(34,197,94,0.2); }
    .hi-tag.locked    { background: rgba(59,130,246,0.1); color: #60a5fa; border: 1px solid rgba(59,130,246,0.2); }
    .hi-title { font-size: 11px; color: #475569; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 120px; }

    .empty-state { text-align: center; padding: 40px 0; }
    .empty-icon { font-size: 28px; margin-bottom: 8px; }
    .empty-state p { font-size: 12px; color: #475569; line-height: 1.6; }

    .hidden { display: none; }

    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.2} }
  </style>
</head>
<body>

<div class="header">
  <div class="header-icon">üîÑ</div>
  <div>
    <h1>Auto Refresh</h1>
    <p>Idle tab refresher</p>
  </div>
</div>

<nav class="nav">
  <button class="active" id="navRefresh">Refresh</button>
  <button id="navHistory">History<span class="badge hidden" id="historyBadge"></span></button>
</nav>

<!-- ‚ïê‚ïê REFRESH PAGE ‚ïê‚ïê -->
<div class="page active" id="pageRefresh">

  <!-- Add form -->
  <div class="form-label">Add tab to watch</div>

  <div class="mode-toggle">
    <button class="active" id="modeTab">Current Tab</button>
    <button id="modeUrl">Custom URL</button>
  </div>

  <div id="tabMode">
    <select id="tab-select"><option value="">Loading tabs‚Ä¶</option></select>
  </div>
  <div id="urlMode" class="hidden">
    <div class="input-row">
      <input type="text" id="urlInput" placeholder="https://example.com" />
      <button class="btn-ghost" id="btnUseCurrent">Use Current</button>
    </div>
  </div>

  <div class="interval-row">
    <div class="form-label">Every</div>
    <div class="interval-pills">
      <button class="interval-pill" data-val="1">1m</button>
      <button class="interval-pill sel" data-val="3">3m</button>
      <button class="interval-pill" data-val="5">5m</button>
      <button class="interval-pill" data-val="10">10m</button>
      <button class="interval-pill" data-val="30">30m</button>
    </div>
    <div class="custom-min">
      <input type="number" id="customInterval" min="1" max="1440" placeholder="‚Äî" />
      <span>m</span>
    </div>
  </div>

  <button class="btn-add" id="btnAdd">Ôºã Add to Watch List</button>

  <!-- Watch list -->
  <div class="section-header">
    <span class="section-title">Watching <span id="watchCount">0</span> tab(s)</span>
  </div>

  <div class="watch-list" id="watchList">
    <div class="empty-watches">
      <div class="icon">üëÄ</div>
      <p>No tabs being watched yet.<br>Add one above to get started.</p>
    </div>
  </div>

</div>

<!-- ‚ïê‚ïê HISTORY PAGE ‚ïê‚ïê -->
<div class="page" id="pageHistory">
  <div class="history-toolbar">
    <span id="historyCount">0 refreshes logged</span>
    <button class="btn-clear" id="btnClearHistory">Clear all</button>
  </div>
  <div class="history-list" id="historyList">
    <div class="empty-state">
      <div class="empty-icon">üïê</div>
      <p>No refreshes yet.<br>Add a tab to watch to see history here.</p>
    </div>
  </div>
</div>

<script src="popup.js"></script>
</body>
</html>
